<Window x:Class="StudySnap.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:StudySnap"
        mc:Ignorable="d"
        Title="StudySnap" Height="800" Width="1000"
        WindowStartupLocation="CenterScreen" MouseDown="Window_MouseDown"
        MinHeight="585" MinWidth="908">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="325"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="50"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Background -->
        <Rectangle Grid.Row="1" Grid.ColumnSpan="2" Fill="#F6F6F8"/>


        <!-- Title bar -->
        <StackPanel Orientation="Horizontal" Grid.Row="0"
                    Grid.ColumnSpan="2" Margin="35,5">
            <Image Height="30" Width="30" Source="/Images/StudySnap Logo 30.png"/>

            <Label Content="StudySnap" Margin="7,0,0,0"
                   VerticalAlignment="Center" FontSize="20"
                   FontFamily="Segoe UI Black"/>
        </StackPanel>

        <!-- Deck Panel -->
        <Rectangle Grid.Row="1" Grid.Column="0" Fill="White"
                   RadiusX="25" RadiusY="25" HorizontalAlignment="Stretch"
                   VerticalAlignment="Stretch" Margin="20,20,15,20"/>

        <Grid Grid.Column="0" Grid.Row="1" Margin="35,35,30,35">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <Label Content="My Decks" FontWeight="Bold" FontSize="18"
                   VerticalAlignment="Top" Grid.Row="0"/>

            <Border Background="#F6F6F8" BorderBrush="#DDDDDE"
                    BorderThickness="1" CornerRadius="15" Height="30"
                    Margin="1,12,1,1" Grid.Row="1">
                <Grid>
                    <TextBlock x:Name="lblSearchPlaceholder"
                               Text="Search decks..." Foreground="#6B7280"
                               FontSize="11" VerticalAlignment="Center"
                               Margin="25,0,0,0" IsHitTestVisible="False"
                               Visibility="{Binding Text.IsEmpty, ElementName=txtbSearchBox, Converter={StaticResource BooleanToVisibilityConverter}}"/>

                    <TextBox x:Name="txtbSearchBox" Background="Transparent"
                             BorderThickness="0" VerticalContentAlignment="Center"
                             FontSize="11" Margin="22,1,1,1"
                             TextChanged="SearchBoxTextChanged"/>
                </Grid>
            </Border>

            <Button Grid.Row="2" Style="{StaticResource RoundedButton15}"
                    Content="Create Deck" Height="30" BorderThickness="0"
                    Background="#135BEC" Foreground="White"
                    FontSize="11" FontWeight="Bold" Margin="1,10"
                    VerticalContentAlignment="Center" Click="CreateDeckClick"/>

            <ListBox Grid.Row="3" x:Name="lstbDecks" SelectionMode="Single"
                     ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                     ScrollViewer.VerticalScrollBarVisibility="Auto"
                     ItemContainerStyle="{StaticResource DeckItemContainerStyle}"
                     Background="Transparent" BorderThickness="0"
                     SelectionChanged="DeckSelectionChanged">

                <ListBox.Resources>
                    <Style TargetType="{x:Type ScrollBar}" BasedOn="{StaticResource ModernScrollBarStyle}"/>
                </ListBox.Resources>

                <ListBox.ItemsPanel>
                    <ItemsPanelTemplate>
                        <WrapPanel Orientation="Horizontal" IsItemsHost="True"/>
                    </ItemsPanelTemplate>
                </ListBox.ItemsPanel>

                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <Grid Width="258" Height="38">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="60"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <Border x:Name="icnBorder" Width="37.5" Height="37.5" Grid.Column="0"
                                    CornerRadius="40" Background="#F3F4F6"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center">
                                <!-- Icon -->
                            </Border>

                            <StackPanel VerticalAlignment="Center" Grid.Column="1"
                                        HorizontalAlignment="Left" Margin="0,0,25,0">
                                <TextBlock Text="{Binding Name}" FontSize="13"
                                           FontWeight="Bold" Foreground="#1F2937"
                                           TextWrapping="NoWrap" TextTrimming="CharacterEllipsis"
                                           ToolTip="{Binding Name}" TextAlignment="Left"/>

                                <TextBlock Text="{Binding Cards.Count, StringFormat='{}{0} cards'}"
                                           FontSize="11" Foreground="#6B7280"
                                           Margin="0,5,0,0" TextAlignment="Left"/>
                            </StackPanel>
                        </Grid>

                        <DataTemplate.Triggers>
                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type ListBoxItem}}, Path=IsSelected}" Value="True">
                                <Setter TargetName="icnBorder" Property="Background" Value="#BCD0F9"/>
                            </DataTrigger>
                        </DataTemplate.Triggers>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>

            <TextBlock x:Name="lblNoDecks" Text="No decks found"
                       HorizontalAlignment="Center" Margin="0,50,0,0"
                       Foreground="#9CA3AF" FontStyle="Italic"
                       Grid.Row="3"/>
        </Grid>


        <!-- Deck Overview -->
        <Rectangle Grid.Row="1" Grid.Column="1" Fill="White" RadiusX="25"
                   RadiusY="25" HorizontalAlignment="Stretch"
                   VerticalAlignment="Stretch" Margin="20,20,15,20"/>

        <Grid x:Name="WelcomeSection" Grid.Row="1" Grid.Column="1">
            <StackPanel HorizontalAlignment="Center"
                        VerticalAlignment="Center" Orientation="Vertical"
                        Margin="0,0,0,50">
                <Border Width="80" Height="80" CornerRadius="40"
                        Background="#E7EEFD" HorizontalAlignment="Center">
                    <!-- Icon -->
                    <Canvas Width="40" Height="40">
                        <Path Fill="#135bec">
                            <Path.Data>
                                <CombinedGeometry GeometryCombineMode="Exclude">
                                    <CombinedGeometry.Geometry1>
                                        <GeometryGroup FillRule="EvenOdd">
                                            <RectangleGeometry Rect="2,2,30,30" RadiusX="3.75" RadiusY="3.75"/>
                                            <RectangleGeometry Rect="4.5,4.5,25,25" RadiusX="1.25" RadiusY="1.25"/>
                                        </GeometryGroup>
                                    </CombinedGeometry.Geometry1>
                                    <CombinedGeometry.Geometry2>
                                        <RectangleGeometry Rect="7.5,7.5,30,30" RadiusX="3.75" RadiusY="3.75"/>
                                    </CombinedGeometry.Geometry2>
                                </CombinedGeometry>
                            </Path.Data>
                        </Path>
                        <Path Fill="#135bec">
                            <Path.Data>
                                <GeometryGroup FillRule="EvenOdd">
                                    <RectangleGeometry Rect="7.5,7.5,30,30" RadiusX="3.75" RadiusY="3.75"/>
                                    <CombinedGeometry GeometryCombineMode="Union">
                                        <CombinedGeometry.Geometry1>
                                            <RectangleGeometry Rect="21.25,13.75,2.5,17.5" RadiusX="1.25" RadiusY="1.25"/>
                                        </CombinedGeometry.Geometry1>
                                        <CombinedGeometry.Geometry2>
                                            <RectangleGeometry Rect="13.75,21.25,17.5,2.5" RadiusX="1.25" RadiusY="1.25"/>
                                        </CombinedGeometry.Geometry2>
                                    </CombinedGeometry>
                                </GeometryGroup>
                            </Path.Data>
                        </Path>
                    </Canvas>
                </Border>

                <TextBlock Text="Create your first deck" FontSize="28"
                           FontWeight="Bold" Foreground="#111827"
                           HorizontalAlignment="Center" Margin="0,20,0,10"/>

                <TextBlock FontSize="16" Foreground="#6B7280"
                           TextWrapping="Wrap" TextAlignment="Center"
                           HorizontalAlignment="Center" Margin="0,0,0,30"
                           MaxWidth="500">Decks are collections of flashcards for a subject.<LineBreak/>Create a deck to start studying.</TextBlock>

                <Border Background="#F9FAFB" CornerRadius="15" Padding="20"
                        MaxWidth="550" HorizontalAlignment="Center"
                        Margin="0,0,0,15" BorderBrush="#F3F4F6"
                        BorderThickness="1">
                    <StackPanel>
                        <Grid Margin="0,0,0,15">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Border Grid.Column="0" Width="25" Height="25"
                                    CornerRadius="15" Background="#CBDAF7">
                                <TextBlock Text="1" Foreground="#135BEC"
                                           FontWeight="Bold"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"/>
                            </Border>
                            <TextBlock Grid.Column="1" Text="Click &quot;Create Deck&quot;"
                                       FontSize="16" Foreground="#4B5563"
                                       VerticalAlignment="Center" Margin="15,0,0,0"/>
                        </Grid>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Border Grid.Column="0" Width="25" Height="25"
                                    CornerRadius="15" Background="#CBDAF7">
                                <TextBlock Text="2" Foreground="#135BEC"
                                           FontWeight="Bold"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"/>
                            </Border>
                            <TextBlock Grid.Column="1" Text="Add cards with questions and answers"
                                       FontSize="16" Foreground="#4B5563"
                                       VerticalAlignment="Center" Margin="15,0,0,0"/>
                        </Grid>
                    </StackPanel>
                </Border>

                <Button Style="{StaticResource RoundedButton15}"
                        Content="Create Deck" Height="30" Width="100"
                        BorderThickness="0" Background="#135BEC"
                        Foreground="White" FontSize="11" FontWeight="Bold"
                        Margin="1,10,1,1" VerticalContentAlignment="Center"
                        Click="CreateDeckClick"/>
            </StackPanel>
        </Grid>

        <Grid x:Name="DeckDetailSection" Grid.Row="1" Grid.Column="1"
              Margin="45,40,45,50" Visibility="Collapsed">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <Grid Grid.Row="0" Margin="0,0,0,30">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0"
                           Text="{Binding SelectedItem.Name, ElementName=lstbDecks}"
                           FontSize="24" FontWeight="Bold" Foreground="#111827"
                           VerticalAlignment="Center" TextWrapping="NoWrap"
                           TextTrimming="CharacterEllipsis"
                           ToolTip="{Binding SelectedItem.Name, ElementName=lstbDecks}"/>

                <Border Grid.Column="1" Background="#E7EEFD" CornerRadius="10" Padding="10,3"
                        Margin="15,0,0,0" VerticalAlignment="Center">
                    <TextBlock Text="{Binding SelectedItem.Cards.Count, ElementName=lstbDecks, StringFormat='Total cards: {0}'}"
                               Foreground="#135BEC" FontWeight="SemiBold" FontSize="11"/>
                </Border>
            </Grid>

            <Grid Grid.Row="1" Margin="0,0,0,25">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="20"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="20"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <Border Grid.Column="0" Background="#F9F9FA" CornerRadius="20" Padding="12">
                    <StackPanel>
                        <TextBlock Text="Last studied" Foreground="#6B7280"
                                   FontSize="11" FontWeight="SemiBold"/>
                        <TextBlock Text="{Binding SelectedItem.LastStudiedDisplay, ElementName=lstbDecks}"
                                   Foreground="#111827" FontWeight="Bold" FontSize="19"/>
                    </StackPanel>
                </Border>

                <Border Grid.Column="2" Background="#F9F9FA" CornerRadius="20" Padding="12">
                    <StackPanel>
                        <TextBlock Text="Best score" Foreground="#6B7280"
                                   FontSize="11" FontWeight="SemiBold"/>
                        <TextBlock Text="{Binding SelectedItem.BestScoreDisplay, ElementName=lstbDecks}"
                                   Foreground="#111827" FontWeight="Bold" FontSize="19"/>
                    </StackPanel>
                </Border>

                <Border Grid.Column="4" Background="#F9F9FA" CornerRadius="20" Padding="12">
                    <StackPanel>
                        <TextBlock Text="Average accuracy" Foreground="#6B7280"
                                   FontSize="11" FontWeight="SemiBold"/>
                        <TextBlock Text="{Binding SelectedItem.AverageAccuracyDisplay, ElementName=lstbDecks}"
                                   Foreground="#111827" FontWeight="Bold" FontSize="19"/>
                    </StackPanel>
                </Border>
            </Grid>

            <Grid Grid.Row="2">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="15"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <Button x:Name="btnStartStudy"
                        Grid.Column="0" Style="{StaticResource RoundedButtonBlue18}"
                        Content="Start Study" Height="35" BorderThickness="0"
                        Background="#135BEC" Foreground="White"
                        FontSize="13.5" FontWeight="SemiBold"
                        VerticalContentAlignment="Center"
                        Click="StartStudyClick"/>

                <Button Grid.Column="2" Style="{StaticResource RoundedButtonGray18}"
                        Content="Edit Deck" Height="35" BorderThickness="0"
                        Background="#E5E7EB" Foreground="#1F2937"
                        FontSize="13.5" FontWeight="SemiBold"
                        VerticalContentAlignment="Center"
                        Click="EditDeckClick"/>
            </Grid>
        </Grid>

        <Button Style="{StaticResource TextOnlyButton}" Grid.Row="1"
                Grid.Column="1" Content="Exit" HorizontalAlignment="Right"
                VerticalAlignment="Bottom" Margin="0,0,40,40"
                Click="ExitButtonClick"/>
    </Grid>
</Window>
